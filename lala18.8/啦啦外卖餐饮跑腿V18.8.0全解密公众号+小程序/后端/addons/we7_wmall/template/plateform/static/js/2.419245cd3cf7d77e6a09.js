webpackJsonp([2],{"+TmT":function(t,e,i){"use strict";var a=i("mtWM"),l=i.n(a),n={name:"Uploader",props:{value:{type:Array,default:function(){return[]}},max:{type:Number|String,default:0},uploadOptions:{type:Object,default:function(){return{type:"h5",dock:"utility/upload"}}}},methods:{onDel:function(t){this.value.splice(t,1),this.$emit("delete",this.value)},onUpload:function(t,e){var i=this;if("h5"==i.uploadOptions.type){if(!e)return;var a=e.target;if(a.files&&a.files.length>0){var n=i.util.getFullUrl("c=utility&a=file&do=upload&type=image&thumb=0");i.$toast.loading({message:"上传中",duration:0});for(var s=0;s<a.files.length;s++){var o=new FormData;o.append("file",a.files[s]),l.a.post(n,o).then(function(e){i.$toast.clear();var a=e.data;a.errno?a.message?alert("上传文件失败, 具体原因:"+a.message):alert("上传文件失败, 具体原因:"+a.error.message):a.url&&a.filename&&(t>0?i.value[t]={url:a.url,filename:a.filename}:i.value.push({url:a.url,filename:a.filename}),console.log(i.value),i.$emit("onGetUrl",i.value))})}}}}}},s={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"uploader"},[i("van-row",{staticClass:"weui-uploader__files",attrs:{gutter:"10"}},[t._l(t.value,function(e,a){return i("van-col",{key:a,attrs:{span:"6"}},[i("div",{staticClass:"weui-uploader__file",style:{backgroundImage:"url("+e.url+")"}},[i("i",{staticClass:"icon icon-close",on:{click:function(e){t.onDel(a)}}})])])}),t._v(" "),t.max>0&&t.value.length<t.max||t.max<=0?i("van-col",{staticClass:"weui-uploader__input-box",attrs:{span:"6"}},[i("div",{staticClass:"weui-uploader__file"},["h5"==t.uploadOptions.type?i("input",{staticClass:"weui-uploader__input",attrs:{type:"file",multiple:"multiple",accept:"image/*"},on:{change:function(e){t.onUpload(-1,e)}}}):t._e(),t._v(" "),t._t("img",[i("i",{staticClass:"icon icon-camerafill"})])],2)]):t._e()],2)],1)},staticRenderFns:[]};var o=i("VU/8")(n,s,!1,function(t){i("yt8p")},null,null);e.a=o.exports},"0Tjp":function(t,e){},ChUX:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mvHQ"),l=i.n(a),n=i("Cz8s"),s=i("+TmT"),o=i("deIj"),r={data:function(){return{id:0,type:"qualification",store:{qualification:{business:{},service:{},more1:{},more2:{}}},qualification:{business:[{url:""}],service:[{url:""}],more1:[{url:""}],more2:[{url:""}]},islegal:!1,showPreLoading:!0}},components:{publicHeader:n.a,uploader:s.a},methods:{onSetImg:function(t,e){this.qualification[t][0].url=e[0].url,this.store.qualification[t].thumb=e[0].filename},onSetBusiness:function(t){this.onSetImg("business",t)},onSetService:function(t){this.onSetImg("service",t)},onSetMore1:function(t){this.onSetImg("more1",t)},onSetMore2:function(t){this.onSetImg("more2",t)},onDelete:function(t,e){this.qualification[t].push({url:""}),this.store.qualification[t].thumb=""},onDeleteBusiness:function(t){this.onDelete("business",t)},onDeleteService:function(t){this.onDelete("service",t)},onDeleteMore1:function(t){this.onDelete("more1",t)},onDeleteMore2:function(t){this.onDelete("more2",t)},onLoad:function(){var t=this;Object(o.a)({url:"plateform/store/shop/setting",vue:t,autoAssign:!0,variable:"store",data:{id:t.id,type:t.type},success:function(e){for(var i in t.islegal=!0,t.store.qualification)"business"!=i&&"service"!=i&&"more1"!=i&&"more2"!=i||(t.qualification[i][0].url=t.store.qualification[i].thumb)}})},onSubmit:function(){var t=this;if(!t.islegal)return!1;t.islegal=!1,Object(o.c)({url:"plateform/store/shop/setting",vue:t,data:{id:t.id,type:t.type,value:l()(t.store.qualification)},redirect:t.util.getUrl({path:"pages/merchant/store/index",query:{id:t.id}}),fail:function(e){t.util.$toast(e),t.islegal=!0}})}},created:function(){this.$route.query&&this.$route.query.id&&(this.id=this.$route.query.id)},mounted:function(){this.onLoad()}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"store-qualification"}},[i("public-header",{attrs:{title:"营业资质"}}),t._v(" "),i("div",{staticClass:"content"},[i("van-cell-group",{staticClass:"border-0px"},[i("van-cell",{attrs:{title:"营业执照"}}),t._v(" "),i("div",{staticClass:"uploader-wrapper flex-lr"},[i("uploader",{attrs:{max:"1",value:t.qualification.business[0]&&t.qualification.business[0].url?t.qualification.business:[]},on:{delete:t.onDeleteBusiness,onGetUrl:t.onSetBusiness}},[i("div",{staticClass:"upload-bg",attrs:{slot:"img"},slot:"img"},[i("i",{staticClass:"icon icon-add"}),t._v("\n\t\t\t\t\t\t请上传营业执照照片\n\t\t\t\t\t")])])],1),t._v(" "),i("van-cell",{attrs:{title:"餐饮服务许可证"}}),t._v(" "),i("div",{staticClass:"uploader-wrapper flex-lr"},[i("uploader",{attrs:{max:"1",value:t.qualification.service[0]&&t.qualification.service[0].url?t.qualification.service:[]},on:{delete:t.onDeleteService,onGetUrl:t.onSetService}},[i("div",{staticClass:"upload-bg",attrs:{slot:"img"},slot:"img"},[i("i",{staticClass:"icon icon-add"}),t._v("\n\t\t\t\t\t\t请上传餐饮服务许可证照片\n\t\t\t\t\t")])])],1),t._v(" "),i("van-cell",{attrs:{title:"更多资质"}}),t._v(" "),i("div",{staticClass:"uploader-wrapper flex-lr"},[i("uploader",{attrs:{max:"1",value:t.qualification.more1[0]&&t.qualification.more1[0].url?t.qualification.more1:[]},on:{delete:t.onDeleteMore1,onGetUrl:t.onSetMore1}},[i("div",{staticClass:"upload-bg",attrs:{slot:"img"},slot:"img"},[i("i",{staticClass:"icon icon-add"}),t._v("\n\t\t\t\t\t\t请上传更多资质一照片\n\t\t\t\t\t")])]),t._v(" "),i("uploader",{attrs:{max:"1",value:t.qualification.more2[0]&&t.qualification.more2[0].url?t.qualification.more2:[]},on:{delete:t.onDeleteMore2,onGetUrl:t.onSetMore2}},[i("div",{staticClass:"upload-bg",attrs:{slot:"img"},slot:"img"},[i("i",{staticClass:"icon icon-add"}),t._v("\n\t\t\t\t\t\t请上传更多资质二照片\n\t\t\t\t\t")])])],1)],1),t._v(" "),i("div",{staticClass:"tip font-14 c-gray padding-15-lr padding-10-tb"},[t._v("建议上传图片前添加水印")]),t._v(" "),i("div",{staticClass:"padding-15"},[i("van-button",{staticClass:"font-16",attrs:{size:"normal",type:"primary",disabled:!t.islegal,block:""},on:{click:t.onSubmit}},[t._v("提交")])],1)],1),t._v(" "),t.showPreLoading?i("iloading"):t._e()],1)},staticRenderFns:[]};var c=i("VU/8")(r,u,!1,function(t){i("0Tjp")},null,null);e.default=c.exports},yt8p:function(t,e){}});