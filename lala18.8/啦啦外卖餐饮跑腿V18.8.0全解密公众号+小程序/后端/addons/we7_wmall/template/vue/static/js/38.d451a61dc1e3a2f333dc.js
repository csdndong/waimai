webpackJsonp([38],{WZ5u:function(t,e){},l5Ps:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Gu7T"),i=s.n(a),c=s("woOf"),n=s.n(c),d=s("Cz8s"),o=s("mzkE"),l=s("deIj"),r={components:{publicHeader:d.a,publicFooter:o.a},data:function(){return{redpackets:{page:1,psize:10,empty:!1,loaded:!1,loading:!1,data:[]},can_exchange:0,exchange_max:0,member_redpackets:[],member:{},month:{},redpacketActive:{},filter:{items:{exchange_cost:-1}},popup:{redpacketExchange:!1},showPreLoading:!0,menufooter:{},islegal:!1}},methods:{onLoad:function(){var t=this;Object(l.a)({vue:t,url:"svip/redpacket/list",data:{page:t.redpackets.page,psize:t.redpackets.psize,exchange_cost:t.filter.items.exchange_cost,menufooter:1},success:function(e){t.can_exchange=e.can_exchange,t.exchange_max=e.exchange_max,t.member=n()(t.member,e.member),t.month=n()(t.month,e.month),t.member_redpackets=[].concat(i()(e.member_redpackets));var s=e.redpackets;t.redpackets.data=[].concat(i()(s)),(!s||s.length<t.redpackets.psize)&&(t.redpackets.loaded=!0),t.redpackets.data.length||(t.redpackets.empty=!0),t.redpackets.page++,t.islegal=!0}})},onGetRedpackets:function(t){var e=this;t&&(e.redpackets={page:1,psize:10,empty:!1,loaded:!1,loading:!0,data:[]}),Object(l.a)({vue:e,url:"svip/redpacket/more",data:{page:e.redpackets.page,psize:e.redpackets.psize,exchange_cost:e.filter.items.exchange_cost},success:function(t){var s=t.redpackets;e.redpackets.data=[].concat(i()(e.redpackets.data),i()(s)),(!s||s.length<e.redpackets.psize)&&(e.redpackets.loaded=!0),e.redpackets.data.length||(e.redpackets.empty=!0),e.redpackets.page++,e.redpackets.loading=!1}})},onToggleExchangeCost:function(t){t!=this.filter.items.exchange_cost&&(this.filter.items.exchange_cost=t)},onTogglePopup:function(t){this.popup[t]=!this.popup[t]},onRedpacketShow:function(t){var e=this;Object(l.a)({vue:e,url:"svip/redpacket/redpacket",data:{id:t},success:function(t){e.redpacketActive=e.util.extend(e.redpacketActive,t.redpacket),e.onTogglePopup("redpacketExchange")}})},onExchange:function(t){var e=this;e.islegal&&(e.islegal=!1,Object(l.c)({vue:e,url:"svip/redpacket/exchange",data:{id:t.id,exchange_cost:e.filter.items.exchange_cost},success:function(t){var s="领取成功";1==e.filter.items.exchange_cost&&(s="兑换成功"),e.util.$toast(s),e.can_exchange=t.can_exchange,t.member_redpackets&&(e.member_redpackets=[].concat(i()(t.member_redpackets))),e.member.svip_credit1=t.svip_credit1,e.onTogglePopup("redpacketExchange"),e.islegal=!0},fail:function(t){e.util.$toast(t),e.onTogglePopup("redpacketExchange"),e.islegal=!0}}))}},mounted:function(){this.$route.query&&this.$route.query.exchange_cost&&(this.filter.items.exchange_cost=this.$route.query.exchange_cost),this.onLoad()},watch:{filter:{handler:function(t,e){this.onGetRedpackets(!0)},deep:!0}}},v={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"svip-redpacket"}},[s("public-header",{attrs:{title:"会员专属红包"}}),t._v(" "),s("public-footer",{attrs:{menufooter:t.menufooter,preLoading:t.showPreLoading}}),t._v(" "),s("div",{staticClass:"content"},[-1==t.filter.items.exchange_cost?s("div",{staticClass:"table"},[s("div",{staticClass:"use-redpacket"},[s("div",{staticClass:"use-redpacket-title"},[t._v(t._s(t.month.endday)+"前可免费领红包："),s("span",{staticClass:"num"},[t._v(t._s(t.can_exchange))]),t._v("个")]),t._v(" "),s("div",{staticClass:"use-redpacket-list"},[t._l(t.member_redpackets,function(e,a){return[s("div",{staticClass:"use-redpacket-item active"},[s("div",{staticClass:"redpacket-info"},[s("div",{staticClass:"price ellipsis"},[s("i",[t._v("¥")]),t._v(" "),s("span",[t._v(t._s(e.discount))])]),t._v(" "),s("div",{staticClass:"info"},[s("div",{staticClass:"font-14 ellipsis"},[t._v(t._s(e.title))]),t._v(" "),e.condition>0?s("div",{staticClass:"font-12 c-gray ellipsis padding-5-t"},[t._v("满"+t._s(e.condition)+"元")]):s("div",{staticClass:"font-12 c-gray ellipsis padding-5-t"},[t._v("无门槛")])])])])]}),t._v(" "),t._l(t.can_exchange,function(e,a){return t.can_exchange>0?s("div",{key:a,staticClass:"use-redpacket-item"},[s("img",{attrs:{src:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNjEiIGhlaWdodD0iNjEiPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggc3Ryb2tlPSIjRjJENDk5IiBzdHJva2Utb3BhY2l0eT0iLjkiIHN0cm9rZS13aWR0aD0iLjUiIGQ9Ik00IC4yNUEzLjc1IDMuNzUgMCAwIDAgLjI1IDR2NTNBMy43NSAzLjc1IDAgMCAwIDQgNjAuNzVoMTUzYTMuNzUgMy43NSAwIDAgMCAzLjc1LTMuNzVWNEEzLjc1IDMuNzUgMCAwIDAgMTU3IC4yNUg0eiIvPjxwYXRoIHN0cm9rZT0iI0YyRDQ5OSIgc3Ryb2tlLW9wYWNpdHk9Ii45IiBzdHJva2Utd2lkdGg9Ii41IiBkPSJNMjYgMGM2IDguMzMzIDkgMTguNSA5IDMwLjVTMzIgNTIuNjY3IDI2IDYxIi8+PHRleHQgZmlsbD0iI0YzRDhBMyIgZm9udC1mYW1pbHk9IlBpbmdGYW5nU0MtTWVkaXVtLCBQaW5nRmFuZyBTQyIgZm9udC1zaXplPSIxMyIgZm9udC13ZWlnaHQ9IjQwMCI+PHRzcGFuIHg9IjYxIiB5PSIzNiI+5b6F6aKG5Y+WPC90c3Bhbj48L3RleHQ+PC9nPjwvc3ZnPg==",alt:""}})]):t._e()})],2)]),t._v(" "),t.redpackets.empty?t._e():s("div",{staticClass:"redpacket-title"},[s("div",{staticClass:"text flex"},[t._v("以下专属红包任意领")])])]):1==t.filter.items.exchange_cost?s("div",{staticClass:"table"},[s("header",{staticClass:"header-bounty"},[s("section",{staticClass:"left-header-bounty"},[s("span",[t._v("奖励金")]),t._v(" "),s("i",[t._v(t._s(t.member.svip_credit1))]),t._v(" "),s("span",[t._v("个")])]),t._v(" "),s("router-link",{staticClass:"right-header-bounty",attrs:{tag:"div",to:t.util.getUrl({path:"/package/pages/svip/record"})}},[s("span",[t._v("兑换记录")]),t._v(" "),s("van-icon",{attrs:{name:"right"}})],1)],1)]):t._e(),t._v(" "),t.redpackets.empty?s("div",{staticClass:"loaded"},[s("div",{staticClass:"loaded-tips"},[t._v("\n\t\t\t\t暂无可领取红包\n\t\t\t")])]):s("van-list",{staticClass:"table",attrs:{finished:t.redpackets.loaded,offset:100,"immediate-check":!1},on:{load:t.onGetRedpackets},model:{value:t.redpackets.loading,callback:function(e){t.$set(t.redpackets,"loading",e)},expression:"redpackets.loading"}},[t._l(t.redpackets.data,function(e,a){return[0==e.sid?[s("section",{staticClass:"redpacket-item"},[s("div",{staticClass:"top"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:"static/img/svip_redpacket.png",alt:""}}),t._v(" "),s("ul",{staticClass:"main"},[s("li",{staticClass:"name"},[s("h3",[t._v(t._s(e.title))])]),t._v(" "),s("li",{staticClass:"price"},[s("i",[t._v("¥")]),t._v(" "),s("span",[t._v(t._s(e.discount))]),t._v(" "),0==e.condition?s("div",[t._v("无门槛红包")]):e.condition>0?s("div",[t._v("满"+t._s(e.condition)+"元可用")]):t._e()])])]),t._v(" "),s("div",{staticClass:"right"},[1==t.filter.items.exchange_cost&&e.exchange_cost>0?s("div",{staticClass:"status ellipsis"},[t._v("需"),s("i",[t._v(t._s(e.exchange_cost)+"个")]),t._v("奖励金")]):t._e(),t._v(" "),1==t.filter.items.exchange_cost&&e.exchange_cost>0?s("div",{staticClass:"button",on:{click:function(s){return t.onRedpacketShow(e.id)}}},[t._v("兑换")]):s("div",{staticClass:"button",on:{click:function(s){return t.onRedpacketShow(e.id)}}},[t._v("领取")])])]),t._v(" "),s("footer",{staticClass:"bottom"},[t._v("\n\t\t\t\t\t\t\t通用红包\n\t\t\t\t\t\t")])])]:e.sid>0?[s("section",{staticClass:"wrapper-item"},[s("div",{staticClass:"item-header"},[s("div",{staticClass:"item-left"},[s("img",{attrs:{src:e.logo,alt:""}}),t._v(" "),s("ul",{staticClass:"item-main"},[s("li",{staticClass:"shop-name"},[s("h3",[t._v(t._s(e.store_title))]),t._v(" "),s("van-icon",{attrs:{name:"right"}})],1),t._v(" "),s("li",{staticClass:"meta"},[t._v("评价"+t._s(e.score)+"分　月售"+t._s(e.sailed)+"份")]),t._v(" "),s("li",{staticClass:"price"},[s("i",[t._v("¥")]),t._v(" "),s("span",[t._v(t._s(e.discount))]),t._v(" "),0==e.condition?s("div",{staticClass:"padding-5-l ellipsis"},[t._v("满任意金额可用")]):e.condition>0?s("div",{staticClass:"padding-5-l ellipsis"},[t._v("满"+t._s(e.condition)+"元可用")]):t._e()])])]),t._v(" "),s("div",{staticClass:"item-right"},[1==t.filter.items.exchange_cost&&e.exchange_cost>0?s("div",{staticClass:"status ellipsis"},[t._v("\n\t\t\t\t\t\t\t\t\t需"),s("i",[t._v(t._s(e.exchange_cost)+"个")]),t._v("奖励金\n\t\t\t\t\t\t\t\t")]):t._e(),t._v(" "),1==t.filter.items.exchange_cost&&e.exchange_cost>0?s("div",{staticClass:"item-button",on:{click:function(s){return t.onRedpacketShow(e.id)}}},[t._v("兑换")]):s("div",{staticClass:"item-button",on:{click:function(s){return t.onRedpacketShow(e.id)}}},[t._v("领取")])])]),t._v(" "),s("ul",{staticClass:"item-footer"},[s("li",[s("h4",[s("span",[t._v("优惠可叠加")])]),t._v(" "),e.activity&&e.activity.items&&e.activity.items.discount?s("span",[t._v(t._s(e.activity.items.discount.title))]):s("span",[t._v("暂无满减活动")])])]),t._v(" "),s("div",{staticClass:"limit-today hide"},[t._v("限今日")])])]:t._e()]}),t._v(" "),t.redpackets.loaded&&!t.redpackets.empty?s("div",{staticClass:"loaded"},[s("div",{staticClass:"loaded-tips"},[t._v("没有更多了")])]):t._e()],2)],1),t._v(" "),s("ul",{staticClass:"wrapper-list"},[s("li",{on:{click:function(e){return t.onToggleExchangeCost(-1)}}},[s("span",{staticClass:"item",class:{active:-1==t.filter.items.exchange_cost}},[t._v("每月领"+t._s(t.exchange_max)+"个红包")])]),t._v(" "),s("li",{on:{click:function(e){return t.onToggleExchangeCost(1)}}},[s("span",{staticClass:"item",class:{active:1==t.filter.items.exchange_cost}},[t._v("奖励金兑换")])])]),t._v(" "),s("van-popup",{attrs:{position:"bottom"},model:{value:t.popup.redpacketExchange,callback:function(e){t.$set(t.popup,"redpacketExchange",e)},expression:"popup.redpacketExchange"}},[s("div",{staticClass:"redpacket-pop"},[s("div",{staticClass:"redpacket-pop-title"},[t._v("领取红包")]),t._v(" "),s("div",{staticClass:"redpacket-info"},[s("div",{staticClass:"flex redpacket-top"},[s("div",{staticClass:"price"},[s("i",[t._v("¥")]),t._v(" "),s("span",[t._v(t._s(t.redpacketActive.discount))])]),t._v(" "),s("div",{staticClass:"redpacket-left"},[s("div",{staticClass:"font-15 font-bold ellipsis"},[t._v(t._s(t.redpacketActive.title))]),t._v(" "),s("div",{staticClass:"font-12 ellipsis padding-5-t c-gray"},[t._v("\n\t\t\t\t\t\t\t满"+t._s(t.redpacketActive.condition>0?t.redpacketActive.condition+"元":"任意金额")+"可用\n\t\t\t\t\t\t\t"),s("span",[t._v("，有效期"+t._s(t.redpacketActive.use_days_limit)+"天")])])])]),t._v(" "),t.redpacketActive.sid>0&&t.redpacketActive.activity&&t.redpacketActive.activity.items&&t.redpacketActive.activity.items.discount?s("div",{staticClass:"flex redpacket-bottom"},[s("div",{staticClass:"redpacket-tips"},[t._v("优惠可叠加")]),t._v(" "),s("div",{staticClass:"font-12 c-default"},[t._v(t._s(t.redpacketActive.activity.items.discount.title))])]):t._e()]),t._v(" "),t.redpacketActive.sid>0&&t.redpacketActive.hot_goods&&t.redpacketActive.hot_goods.length>0?s("div",{staticClass:"hot-goods margin-15-t"},[s("div",{staticClass:"flex-lr"},[s("div",{staticClass:"font-14 font-bold"},[t._v("热销商品")]),t._v(" "),s("router-link",{staticClass:"font-12 c-gray",attrs:{tag:"div",to:t.util.getUrl({path:"/pages/store/goods",query:{sid:t.redpacketActive.sid}})}},[t._v("查看更多商品 "),s("span",{staticClass:"icon icon-right font-12"})])],1),t._v(" "),s("div",{staticClass:"goods-list flex margin-10-t"},t._l(t.redpacketActive.hot_goods,function(e,a){return s("router-link",{key:e.id,staticClass:"goods-item",attrs:{tag:"div",to:t.util.getUrl({path:"/pages/store/goodsDetail",query:{sid:t.redpacketActive.sid,id:e.id}})}},[s("img",{attrs:{src:e.thumb,alt:""}}),t._v(" "),s("div",{staticClass:"goods-title"},[t._v(t._s(e.title))]),t._v(" "),s("div",{staticClass:"goods-price"},[s("i",[t._v("¥")]),t._v(" "),s("span",[t._v(t._s(e.price))])])])}),1)]):t._e(),t._v(" "),s("van-button",{staticClass:"bg-danger font-16 margin-15-t",attrs:{size:"normal",disabled:!t.islegal||1==t.filter.items.exchange_cost&&t.redpacketActive.exchange_cost>t.member.svip_credit1,block:""},on:{click:function(e){return t.onExchange(t.redpacketActive)}}},[1==t.filter.items.exchange_cost&&t.redpacketActive.exchange_cost>t.member.svip_credit1?[t._v("\n\t\t\t\t\t余额不足(需"+t._s(t.redpacketActive.exchange_cost)+"个奖励金)\n\t\t\t\t")]:[1==t.filter.items.exchange_cost?[t._v("\n\t\t\t\t\t\t立即兑换(需"+t._s(t.redpacketActive.exchange_cost)+"个奖励金)\n\t\t\t\t\t")]:-1==t.filter.items.exchange_cost?[t._v("\n\t\t\t\t\t\t立即领取\n\t\t\t\t\t")]:t._e()]],2),t._v(" "),s("div",{staticClass:"bounty"},[t._v("奖励金余额："+t._s(t.member.svip_credit1)+"个")])],1)])],1)},staticRenderFns:[]};var p=s("VU/8")(r,v,!1,function(t){s("WZ5u")},null,null);e.default=p.exports}});